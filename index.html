<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>You Are Not Alone – Film</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles/main.css" />
</head>
<body>
  <!-- VIDEO GATE -->
  <section id="video-gate">
    <div class="gate-inner">
      <div class="video-shell">
        <video
          id="film"
          controls
          autoplay
          muted
          playsinline
          poster="assets/images/poster-frame.jpg"
        >
          <source src="https://github.com/m-crow-m/notalone/releases/download/v1.0/you-are-not-alone.mp4" type="video/mp4" />
          Your browser does not support video playback.
        </video>

        <div class="control-bar" aria-label="Custom video controls">
          <button type="button" id="play-toggle" class="control-button">Pause</button>
          <button type="button" id="mute-toggle" class="control-button">Sound on</button>
          <button type="button" id="restart" class="control-button">Restart</button>
          <div class="progress" aria-hidden="true">
            <span id="progress-fill"></span>
          </div>
        </div>
      </div>

      <p class="gate-note">
        Best experienced in a dark room with headphones.
      </p>

      <!-- Optional escape hatch if you want it -->
      <button type="button" id="skip-link" class="skip-link">
        Skip to site
      </button>
    </div>
  </section>

  <!-- REST OF SITE (HIDDEN UNTIL VIDEO ENDS) -->
  <div id="site-content" class="hidden">
    <div class="page">
      <header>
        <h1>You Are Not Alone</h1>
        <div class="meta">
          2025 · Short film · AI and design
        </div>
      </header>

      <section class="section" id="context">
        <h2>Project context</h2>
        <p>
          [Your text here about the assignment and what this piece is.]
        </p>
      </section>

      <section class="section" id="statement">
        <h2>Artist statement</h2>
        <p>
          [Your artist statement lives here.]
        </p>
      </section>

      <section class="section" id="process">
        <h2>Process and AI</h2>
        <p>
          [Notes on Pika, Suno, Premiere, what you rejected, etc.]
        </p>
      </section>

      <section class="section" id="research">
        <h2>Research context</h2>
        <p>
          [Short paragraph about your research question and AI and emotion.]
        </p>
      </section>

      <section class="section" id="credits">
        <h2>Credits</h2>
        <p class="credits">
          Concept, direction, edit: [Your name]<br />
          Course: AI and Design, Eastern Washington University<br />
          Instructor: Travis Masingale<br />
          Tools: Pika, Suno, Premiere Pro, Adobe suite
        </p>
      </section>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const video = document.getElementById("film");
      const gate = document.getElementById("video-gate");
      const siteContent = document.getElementById("site-content");
      const skipLink = document.getElementById("skip-link");
      const playToggle = document.getElementById("play-toggle");
      const muteToggle = document.getElementById("mute-toggle");
      const restartButton = document.getElementById("restart");
      const progressFill = document.getElementById("progress-fill");

      function openSite() {
        if (!gate || !siteContent) return;
        gate.classList.add("hidden");
        siteContent.classList.remove("hidden");
        localStorage.setItem("videoWatched", "true");
        window.scrollTo({ top: 0, behavior: "instant" });
      }

      // If viewer has already watched once, open the site directly
      if (localStorage.getItem("videoWatched") === "true") {
        openSite();
      } else {
        if (video) {
          video.addEventListener("ended", openSite);
          video.addEventListener("timeupdate", () => {
            if (!progressFill || !video.duration) return;
            const percent = (video.currentTime / video.duration) * 100;
            progressFill.style.width = `${percent}%`;
          });

          video.addEventListener("play", () => {
            if (playToggle) playToggle.textContent = "Pause";
          });

          video.addEventListener("pause", () => {
            if (playToggle) playToggle.textContent = "Play";
          });

          video.addEventListener("volumechange", () => {
            if (!muteToggle) return;
            muteToggle.textContent = video.muted ? "Sound on" : "Mute";
          });
        }
      }

      // Optional skip link
      if (skipLink) {
        skipLink.addEventListener("click", function (e) {
          e.preventDefault();
          openSite();
        });
      }

      if (playToggle && video) {
        playToggle.addEventListener("click", () => {
          if (video.paused) {
            video.play();
          } else {
            video.pause();
          }
        });
      }

      if (muteToggle && video) {
        muteToggle.addEventListener("click", () => {
          video.muted = !video.muted;
          muteToggle.textContent = video.muted ? "Sound on" : "Mute";
        });
      }

      if (restartButton && video) {
        restartButton.addEventListener("click", () => {
          video.currentTime = 0;
          video.play();
        });
      }
    });
  </script>
</body>
</html>
